---
import { type Props as SEOProps, SEO as AstroSEO } from 'astro-seo'

import { BASE_URL } from '@/lib/baseUrl'
import { mainMetaData } from '@/lib/metaData'

interface Props extends SEOProps {
  imageUrl?: string
  type?: 'article' | 'website' | 'profile'
  slot: 'seo'
}

const { props } = Astro

// Get the current URL and construct canonical URL
const currentPath = Astro.url.pathname
const canonicalURL = `${BASE_URL}${currentPath}`

const metaData = {
  title: props.title ?? mainMetaData.title,
  description: props.description ?? mainMetaData.description,
  image: props.imageUrl ?? `${BASE_URL}/images/og_main.png`
}

const defaultProps: SEOProps = {
  title: metaData.title,
  titleDefault: metaData.title,
  description: metaData.description,
  canonical: props.canonical ?? canonicalURL,
  openGraph: {
    basic: {
      image: metaData.image,
      title: metaData.title,
      type: props.type ?? 'website',
      url: canonicalURL,
      ...props.openGraph?.basic
    },
    optional: {
      siteName: mainMetaData.title,
      description: metaData.description,
      ...props.openGraph?.optional
    }
  },
  twitter: {
    title: metaData.title,
    description: metaData.description,
    creator: '@0xtaufeeq',
    card: 'summary_large_image',
    image: metaData.image,
    imageAlt: metaData.title
  }
}

const combinedProps = { ...defaultProps, ...props }
---

<AstroSEO {...combinedProps} />
